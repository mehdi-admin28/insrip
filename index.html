<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

<form id="formsignin">
  <p>email</p>
  <input type="email" id="email01">
  <p>mot de passe</p>
  <input type="password" id="mdp">
  <button type="submit">S'inscrire</button>
</form>

<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries
  import { getAuth, createUserWithEmailAndPassword, sendEmailVerification, reload, signOut ,deleteUser} from "https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js";
 


  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyAVcBTgJwhRiUTe4asV41OtZqAPmt27fgU",
    authDomain: "sidialilebhar-project.firebaseapp.com",
    projectId: "sidialilebhar-project",
    storageBucket: "sidialilebhar-project.firebasestorage.app",
    messagingSenderId: "824231980604",
    appId: "1:824231980604:web:bb8f38834326acf9149d39"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);

const auth = getAuth();
  /*-------------------email / mot de passe----------------*/
const formSI = document.getElementById('formsignin');
const mdp = document.getElementById('mdp');
const email01 = document.getElementById('email01');


formSI.addEventListener("submit",(e)=>{
  e.preventDefault();
 const email = email01.value;
 const password = mdp.value;

createUserWithEmailAndPassword(auth, email, password)
  .then((userCredential)=>{
    alert("réeuuuuuussssiiii");
    // Signed up 
    const user = userCredential.user;

    /*SEUL-----------sendEmailVerification(user, actionCodeSettings)-------*/
  const actionCodeSettings ={url:'https://mehdi-admin28.github.io/insrip/',handleCodeInApp: true};
sendEmailVerification(user, actionCodeSettings)
  .then(()=>{
   alert('message envoyer vers votre email');})
  .catch(()=>{alert("l email n existe pas ou errur de l envoi du message vers l email")});
    
/*------------------------verifier l email-----------------*/
setTimeout(()=>{alert("veuiiler cofirmer le message qu on a envoyer vers votre email");},1200000)
if(user){
alert("user existe");

user.reload()
.then(()=>{
      if(user.emailVerified){
        alert("vous étes inscrie avec succé")
      }
      else{
        /*en suprime l utilisateur aprés 5min par example*/
          alert("votre compte utilisateur a été supprimer car vous n avez pas valider le message envoyer vers votre email");
          deleteUser(user); 
      };

})
.catch(()=>{alert("le reload a echoué")});
}
else{
  alert("normalement impossible que le user n existe pas c est juste pour test !!!")
};
})

/*-----------------fin de verification d email----------------------*/
  .catch((error) => {
    alert("nnnnnooooonnnnnn");
    const errorCode = error.code;
    const errorMessage = error.message;
    // ..
  });

});
</script>

<script src="./sidi1.js"></script>
</body>
</html>